<!DOCTYPE html>
<html>
<head>
	<title>Basico</title>
	<link rel="stylesheet" type="text/css" href="../bootstrap/css/bootstrap.css">
	<script type="text/javascript" src="../jquery-3.2.0.min.js"></script>
	<script type="text/javascript" src="../bootstrap/js/bootstrap.js"></script>
  <script src="../blockly/blockly_compressed.js"></script>
  <script src="../blockly/blocks_compressed.js"></script>
  <script src="../blockly/javascript_compressed.js"></script>
  <script src="../blockly/msg/js/es.js"></script>
  <script type="text/javascript" src="../js/gramaticaBasica.js"></script>
  <script type="text/javascript" src="../js/jscodigo3d.js"></script>
  <script type="text/javascript" src="../js/errores.js"></script>
  <script type="text/javascript" src="../js/ejecutar.js"></script>
</head>
<body>
  <nav class="navbar navbar-inverse">
    <div class="container">
      <div class="navbar-header">
        <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target=".navbar-collapse">
          <span class="sr-only">Toggle navigation</span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="#">Basic 3D</a>
      </div>
      <div class="navbar-collapse collapse">
        <ul class="nav navbar-nav">
          <li class="active"><a href="basico.html">Nivel basico</a></li>
          <li><a href="#">Nivel intermedio</a></li>
          <li><a href="avanzado.html">Nivel avanzado</a></li>
          <li class="dropdown">
            <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Opciones <span class="caret"></span></a>
            <ul class="dropdown-menu">
              <li><a href="#">Tabla de simbolos</a></li>
              <li><a href="#">Reporte de errores</a></li>
              <li><a href="#">Something else here</a></li>
              <li role="separator" class="divider"></li>
              <li class="dropdown-header">Nav header</li>
              <li><a href="#">Separated link</a></li>
              <li><a href="#">One more separated link</a></li>
            </ul>
          </li>
        </ul>
      </div><!--/.nav-collapse -->
    </div>
  </nav>
  <div class="container">
    <div class="row">
      <div>
        <div class="col-md-8"></div>
        <div class="col-md-4"></div>
      </div>
    </div>
  </div>
  <div class="container">
    <div class="row">
      <div class="col-md-8">
        <div id="blocklyDiv" style="height: 600px; width: 100%;"></div>
        <xml id="toolbox" style="display: none">
          <category name = "Expresion" colour="200">
            <block type="math_number"></block>
            <block type="math_arithmetic"></block>
            <block type="logic_compare"></block>
            <block type="logic_operation"></block>
            <block type="logic_negate"></block>
            <block type="logic_boolean"></block>
            <block type="logic_null"></block>
            <block type="text"></block>
            <block type="text_join"></block>
          </category>
          <category name="Variables" custom="VARIABLE" colour = "330"></category>
          <category name="Control" colour = "210">
            <block type="controls_if"></block>
          </category>
          <category name="Ciclos" colour="120">
            <block type="controls_repeat_ext">
              <value name="TIMES">
                <block type="math_number">
                  <field name="NUM">10</field>
                </block>
              </value>
            </block>
            <block type="controls_whileUntil"></block>
            <block type="controls_for">
              <value name="FROM">
                <block type="math_number">
                  <field name="NUM">1</field>
                </block>
              </value>
              <value name="TO">
                <block type="math_number">
                  <field name="NUM">10</field>
                </block>
              </value>
              <value name="BY">
                <block type="math_number">
                  <field name="NUM">1</field>
                </block>
              </value>
            </block>
            <block type="controls_flow_statements"></block>
          </category>
        </xml>
        <script>
          var workspace = Blockly.inject('blocklyDiv',
              {toolbox: document.getElementById('toolbox')});
        </script>
      </div>
      <div class="col-md-4">
        <div class="row">
          <textarea style="height: 600px; width: 100%;" id = "taSalida"></textarea>
          <button onclick="runJS()">Run Code</button>
          <script type="text/javascript">
            setInterval('runJS()', 1);
            function runJS() {
              Blockly.JavaScript.addReservedWords('code');
              var code = Blockly.JavaScript.workspaceToCode();
              code = "Principal() {\n" + code + "\n}";
              try {
                var raiz = gramaticaBasica.parse(code);
                reiniciar3d();
                //crear la tabla de simbolos
                //buscar el nodo del metodo Principal
                var principal = buscarPrincipal(raiz);
                console.log(principal);
                if(principal !== null)
                  ejecutarArbol(principal);
                else
                  alert("No existe un metodo principal");
                console.log(raiz);
                console.log(codigo3d);
              } catch (e) {
                //$("#taEstructuras").html(String(e));
                console.log(e);
              }
              $('#taSalida').text(code);
            }

          </script>
        </div>
      </div>
    </div>
  </div>
</body>
</html>
